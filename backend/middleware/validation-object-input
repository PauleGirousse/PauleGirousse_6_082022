// Regex pour les champs de type "chaines de caractères"
const regexp = /^[a-zA-Zàâäéèêëïîôöùüç0-9'\-,&!.\s]+$/;

// Pour valider les champs des inputs de la sauce à créer selon la regexp
module.exports = (req, res, next) => {
  const sauceObject = JSON.parse(req.body.sauce);
  if (
    regexp.test(sauceObject.name) &&
    regexp.test(sauceObject.manufacturer) &&
    regexp.test(sauceObject.description) &&
    regexp.test(sauceObject.mainPepper)
  ) {
    next();
  } else {
    return res.status(400).json({
      error: "Champs invalides",
    });
  }
};
